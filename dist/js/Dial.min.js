!function(t,e){"use strict";var i=t.document,n="touchstart",s="touchmove",o="touchend",l=Array.prototype.slice,a=Object.prototype.hasOwnProperty,h=Object.prototype.toString,r=function(t){this.config=this._extend({},r.config,t),this._init()};r.config={initAngle:0,radius:0,block:"",target:"",position:"center bottom",usePosition:!0,useBlockPosition:!0,useTransition:!0,useBlockAlwaysUp:!0,useBlockToAngle:!1,useClick:!0,step:1,oneStep:!1,lock:!1,autoPlay:!1,link:!1,onSlideStart:null,onSlideMove:null,onSlideEnd:null},r.prototype={constructor:r,uuid:0,handleEvent:function(t){switch(t.type){case n:this._start(t);break;case s:this._move(t);break;case o:this._end(t)}},_extend:function(t,e){var i,n=l.call(arguments),s=n.length,o=[t];if(1===s)return t;if("boolean"==typeof(i=n[s-1])&&(n.pop(),o[2]=i),n.shift(),s=n.length,s>1)for(var r=0;s>r;r++)o[1]=n[r],this._extend.apply(null,o);else for(var c in e)a.call(e,c)&&(i===!0&&"[object Object]"===h.call(e[c])?this._extend(t,e[c],!0):t[c]=e[c]);return t},_alwaysUp:function(t){if(this.config.useBlockAlwaysUp){var e=this.config.block;if(e&&e.length)for(var i=0,n=e.length;n>i;i++)this._transform(e[i],{translate:!0,rotate:-this.angle},t),this._data(e[i],{rotate:-this.angle})}},_init:function(){var e,s=this.config,o=s.target,l=s.block;if(!this.hasInited){if("string"==typeof o&&(o=i.querySelector(o)),1===o.nodeType&&(s.initAngle%=360,this.target=o,this.dialInitAngle=(s.initAngle-90)%360,this.angle=s.initAngle||0,this._rotate(s.initAngle),this.activeIndex=0,s.useBlockToAngle&&(s.useBlockAlwaysUp=!1),s.usePosition&&this._position(o),this.center=this._center(o),"string"==typeof l)){try{l=i.querySelectorAll(l)}catch(a){}if(l.length||(s.step=s.useBlockPosition=s.useBlockAlwaysUp=s.useBlockToAngle=!1),1===l.nodeType&&(l=[l]),s.useBlockPosition){var h,c,u,f,g,d,p=s.radius;s.block=l,e=parseFloat(360/l.length);for(var _=0,y=l.length;y>_;_++)u=l[_],h=parseFloat(t.getComputedStyle(u,null).width||0),c=parseFloat(t.getComputedStyle(u,null).height||0),u.style.position="absolute",u.style.left="50%",u.style.top="50%",u.style.marginLeft="-"+h/2+"px",u.style.marginTop="-"+c/2+"px",f=p*Math.sin(e*_*Math.PI/180),g=-p*Math.cos(e*_*Math.PI/180),s.useBlockToAngle?d=e*_:s.useBlockAlwaysUp&&(d=-this.angle),this._transform(u,{translate:{x:f,y:g},rotate:d},!1),this._data(u,{translate:{x:f,y:g},rotate:d,target:u});s.eachAngle=e}}this.hasInited=!0,r.list||(r.list=[]),r.list.push(this)}s.lock||this._bind(n),s.autoPlay&&this.start()},_position:function(t){var e,i,n=this.config.position;e={left:"0%",right:"100%",top:"0%",bottom:"100%",center:"50%"},n=n.trim().split(" "),(/^(t|b)/.test(n[0])||/^c/.test(n[0])&&/^(l|r)/.test(n[1]))&&(i=n[0],n[0]=n[1],n[1]=i),t.style.left=e[n[0]],t.style.top=e[n[1]],t.style.marginLeft=-(t.clientWidth/2)+"px",t.style.marginTop=-(t.clientHeight/2)+"px"},_bind:function(t,e,i){(e||this.target).addEventListener(t,this,!!i)},_unbind:function(t,e,i){(e||this.target).removeEventListener(t,this,!!i)},_center:function(t){var e=t.getBoundingClientRect(t);return{x:e.right-e.width/2,y:e.bottom-e.height/2}},_data:function(t,i,n){var s,o,l=this.cache;if(l||(this.cache=l={}),s=t.uuid,s===e&&(t.uuid=s=this.uuid++),o=l[s],o||(o=l[s]={}),i===e&&delete l[s],i!==e){if("string"==typeof i)return n!==e&&(o[i]=n),o[i];if("[object Object]"===h.call(i))return this._extend(o,i)}},_slide:function(t){t.call(this),this._link(t)},_link:function(t){var e=r.list;if(e.length)for(var i=0,n=e.length;n>i;i++){var s=e[i];s.config.link&&this!==s&&t.call(s)}},_transform:function(){function t(e){if("object"==typeof e){for(var i in e)e.hasOwnProperty(i)&&(e[i]=t(e[i]));return e}return"number"==typeof e&&(e+=""),o.test(e)&&(e="0"),e}var e,i,n,s,o=/e-/g;return s={translate:function(e){return"number"==typeof e&&(e={x:e,y:e}),e=t(e),"translate("+e.x+"px, "+e.y+"px)"},scale:function(e){return"number"==typeof e?e="scale("+e+")":"object"==typeof e&&(e+="scale("+e.x+", "+e.y+")"),t(e)}},"skew rotate".split(" ").forEach(function(e){s[e]=function(i){return e+"("+t(i)+"deg)"}}),function(t,o,l){i=[];for(n in o)o.hasOwnProperty(n)&&(o[n]===!0&&(o[n]=this._data(t,n)||0),e=s[n].call(this,o[n],t),i.push(e));this._data(t,o),e=i.join(" "),t.style.transform=e,t.style.webkitTransform=e,this.config.useTransition&&l!==!1&&(t.style.transition="transform .3s ease-in",t.style.webkitTransition="-webkit-transform .3s ease-in")}}(),_start:function(t){var e=t.touches[0];t.preventDefault(),this.startX=e.clientX,this.startY=e.clientY,this.startAngle=this._angle({x:this.startX,y:this.startY},this.center),this._bind(s),this._bind(o),this.config.onSlideStart&&this.config.onSlideStart.call(this)},_move:function(t){var e,i,n,s=t.touches[0],o=this.startAngle;t.preventDefault(),e=this._angle({x:s.clientX,y:s.clientY},this.center),i=this.lAngle||o,e>0&&e-i>=180&&(e-=360),0>e&&-180>=e-i&&(e+=360),this._slide(function(){n=this.angle,this._rotate(n+=e-i),this.config.oneStep||(this.angle=n),this._alwaysUp()}),this.slideAngle=e-o,this.slideMoveAngle=e-i,this.lAngle=e,this.move=!0,this.config.onSlideMove&&this.config.onSlideMove.call(this)},_end:function(t){var e,i,n=t.touches[0]?t.touches[0]:t.changedTouches[0],s=this.config,o=s.eachAngle;if(t.preventDefault(),this.endX=n.clientX,this.endY=n.clientY,s.useClick&&(e=s.block)&&(i=e.length)&&!this.move){for(var l=0;i>l;l++)if(e[l]===t.target||e[l].contains(t.target)){var a=0,h=this.startAngle,r=this.dialInitAngle;r>h&&(h+=360),180>=h-r&&(a-=Math.round((h-r)/o)*o),h-r>180&&(a+=Math.round((360-(h-r))/o)*o),this.slideAngle=a,this._slide(function(){this._rotate(this.angle+=a),this._alwaysUp(),this._activeIndex()});break}}else if(s.step){var c=this;this._slide(function(){this._step(c.slideAngle),this._activeIndex()})}this.config.onSlideEnd&&this.config.onSlideEnd.call(this),this.lAngle=null,this.move=!1,this.slideAngle=0,this.slideMoveAngle=0},_step:function(t){var e=this.angle,i=this.config,n=i.eachAngle;if(n*=this.config.step,i.oneStep){var s=Math.round(t/n);t=s>0?n:0>s?-n:0,e+=t}else e=this.dialInitAngle+Math.round((e-this.dialInitAngle)/n)*n;this._rotate(this.angle=e),this._alwaysUp()},_angle:function(t,e){var i=t.x-e.x,n=t.y-e.y;return Math.round(180*Math.atan2(n,i)/Math.PI)},_activeIndex:function(){var t=this.config.eachAngle,e=this.angle-this.config.initAngle;t&&(this.activeIndex=e>0?(360-e%360)/t:-(e%360)/t)},slideTo:function(t){var e=this.config,i=e.eachAngle,n=e.step,s=this.activeIndex,o=n*i;t!==s&&(o=s>t?(t-(s-e.block.length))*o:(t-s)*o,o=180>=o?-o:360-o,this._slide(function(){this._rotate(this.angle+=o),this._alwaysUp(),this._activeIndex()}))},_unBindEvents:function(){this._unbind(n),this._unbind(s),this._unbind(o)},lock:function(){this._unBindEvents(),this.config.lock=!0,this._init()},unLock:function(){this._unBindEvents(),this.config.lock=!1,this._init()},destroy:function(){this._unBindEvents(),r.list.splice(this,1)},start:function(i,n){function s(e){e.timer=t.setInterval(function(){e._rotate(e.angle+=n?h:-h),e._alwaysUp()},i||1e3)}var o=this.config,l=o.eachAngle,a=o.step,h=a*l;"boolean"==typeof i&&(n=i,i=e),this.stop(),s(this),this._link(function(){s(this)})},stop:function(){this._slide(function(){this.timer&&(clearInterval(this.timer),this.timer=null)})},slideMove:function(t){var e=this.config,i=this.angle;this._slide(function(){e.oneStep?(this._step(t),this._activeIndex()):(this._rotate(i+=t),this.angle=i,this._alwaysUp())})},getIndex:function(){return this.activeIndex}},"translate rotate scale skew".split(" ").forEach(function(t){r.prototype["_"+t]=function(i,n,s){var o={};i!==e&&(n=n||this.target,"number"==typeof i?o[t]=i:"[object Object]"===h.call(i)&&this._extend(o,i),this._transform(n,o,s))}}),"next prev".split(" ").forEach(function(t){r.prototype[t]=function(){var e=this.config,i=e.eachAngle,n=e.step,s=n*i;"prev"===t?this.angle+=s:this.angle-=s,this._rotate(this.angle),e.useBlockAlwaysUp&&this._alwaysUp(),this._activeIndex()}}),"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=r:(t.Dial=r,"function"==typeof define&&define.amd&&define("dial",[],function(){return r}))}(this);